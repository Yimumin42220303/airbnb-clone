# 알림 기능 반영 시뮬레이션 결과

## 1. 검토 항목

| 항목 | 결과 | 비고 |
|------|------|------|
| **Prisma 스키마** | ✅ | User에 `notifications` 관계 추가만 필요. 기존 모델과 충돌 없음. |
| **인증 패턴** | ✅ | `getServerSession(authOptions)`, `(session as { userId?: string })?.userId` 기존 API와 동일하게 사용. |
| **헤더 구조** | ✅ | `nav` 내 `UserMenu` 왼쪽에 벨 컴포넌트 삽입 가능. 로그인 시에만 렌더하는 클라이언트 컴포넌트로 분리. |
| **아이콘** | ✅ | `lucide-react`에 `Bell` 존재. 추가 패키지 불필요. |
| **연동 지점** | ✅ | 호스트 승인/거절, 메시지 전송, 예약 생성, 결제 검증, 예약 취소 API에서 각각 수신자 확보 가능. |

## 2. 연동 지점별 수신자·데이터

| 연동 위치 | 수신자 | 필요한 데이터 |
|-----------|--------|----------------|
| `PATCH /api/host/bookings/[id]` (accept) | 게스트 | `booking.userId`, `booking.id`, `listing.title` |
| `PATCH /api/host/bookings/[id]` (reject) | 게스트 | `booking.userId`, `booking.id` |
| `POST /api/conversations/[id]/messages` | 대화 상대방 | `conversation.booking.userId`, `conversation.booking.listing.userId`, 발신자와 비교해 상대방 결정 |
| `POST /api/bookings` | 호스트 | `listing.userId` (listing 조회 시 select에 추가) |
| `POST /api/payments/verify` | 호스트 | `fullBooking.listing.userId` (이미 로드됨) |
| `POST /api/bookings/[id]/refund` | 호스트 | `booking.listing.userId` (listing include에 userId 또는 user.id 추가) |

## 3. 결론

**문제 없이 반영 가능.** 위 연동 지점에 알림 생성 로직을 추가하고, 신규 API·헤더 벨 UI를 구현하면 됨.
