# 메시지창 한국어 ↔ 일본어 자동 번역 기능 Feasibility 검토

**검토일**: 2025년 2월  
**범위**: 게스트·호스트 메시지창(`/messages/[id]`)에서 상대방 메시지의 한국어↔일본어 번역

---

## 1. 기술적 타당성 (Feasibility)

### 1.1 현재 구조

| 항목 | 내용 |
|------|------|
| **메시지 표시** | `MessageThread.tsx` (클라이언트)에서 `messages[].body`, `senderName` 등 렌더링 |
| **메시지 저장** | `Message.body` (최대 2,000자), 언어 정보 없음 |
| **API** | `GET /api/conversations/[id]/messages` → 목록 반환, `POST` → 전송 |
| **역할** | 게스트(한국어 주 사용), 호스트(한국어/일본어 – `HostLocale` ko \| ja) |

### 1.2 구현 방향 (3가지)

| 방식 | 설명 | 장점 | 단점 |
|------|------|------|------|
| **A. 온디맨드 번역** | 메시지 옆 "번역" 버튼 클릭 시 API 호출 → 번역문 표시 | 비용 최소(필요할 때만), 구현 단순 | 사용자가 매번 클릭 필요 |
| **B. 자동 번역(표시 시)** | 상대방 메시지 로드 시 자동으로 번역 API 호출 후 표시 | UX 매끄러움 | 조회만 해도 비용 발생, 폴링 시 반복 호출 위험 |
| **C. 전송 시 번역 저장** | 메시지 전송 시 원문+번역문을 DB에 저장 | 조회 시 API 비용 없음 | 저장 공간·스키마 변경, 양방향 저장 로직 필요 |

**권장**: **A (온디맨드) + 번역 결과 캐시**.  
- 메시지별로 “번역 보기” 버튼 제공, 클릭 시에만 번역 API 호출.  
- 같은 메시지는 **캐시**(메모리 또는 DB/캐시 테이블)에 저장해 재요청 시 API 비용 없음.

### 1.3 연동 포인트

- **클라이언트**: `MessageThread.tsx`에서 각 메시지에 "번역" 버튼 추가, 클릭 시 `GET /api/translate?text=...&target=ko|ja` (또는 POST body) 호출 후 번역문 표시.
- **서버**: 신규 `POST /api/translate` (또는 `GET` + 쿼리)에서 외부 번역 API 호출, 필요 시 캐시 조회/저장.
- **언어 감지**: 번역 API 대부분 자동 감지 지원(한/일 구분). 또는 `Accept-Language`/호스트 로케일로 “기본 표시 언어”만 정하고, 번역 방향은 **항상 “상대 언어 → 내 언어”**로 고정(예: 내가 ko면 상대 메시지를 ja→ko로 번역).

**결론**: 기존 메시지 흐름을 건드리지 않고, 버튼·API·캐시만 추가하면 **기술적으로 실현 가능**합니다.

---

## 2. 번역 API별 비용 (한↔일, 문자 기준)

한국어·일본어는 모두 **문자 단위 과금**이며, 2,000자 제한 메시지 기준으로 비교합니다.

### 2.1 Google Cloud Translation API

| 항목 | 내용 |
|------|------|
| **요금** | **$20 / 100만 문자** (Basic v2 / Advanced v3 표준 NMT) |
| **무료** | **월 50만 문자** (만료 없음) |
| **한↔일** | 지원, 동일 단가 |
| **예시** | 월 10만 문자 ≈ $0 (무료 구간), 월 100만 문자 ≈ $10 (50만 무료 후 $10) |

- [Pricing \| Cloud Translation](https://cloud.google.com/translate/pricing)

### 2.2 DeepL API

| 항목 | 내용 |
|------|------|
| **Free** | **월 50만 문자** 무료 (한국어·일본어 지원) |
| **Pro** | 월 정액 + 문자당 과금 (상세는 공식 요금표 참고), 무료 문자 없음 |
| **예시** | 소규모 서비스는 **Free만으로** 월 50만 문자까지 가능 |

- [DeepL API Free](https://support.deepl.com/hc/en-us/articles/360021200939-DeepL-API-Free)

### 2.3 Azure Translator (Foundry Tools)

| 항목 | 내용 |
|------|------|
| **요금** | **$10 / 100만 문자** (표준 텍스트 번역) |
| **무료** | 일정 한도(문서 확인) 내 무료 티어 있을 수 있음 |
| **한↔일** | 지원 |

- [Azure Translator pricing](https://azure.microsoft.com/en-us/pricing/details/cognitive-services/translator/)

### 2.4 OpenAI (기존 프로젝트에 OPENAI_API_KEY 사용)

| 항목 | 내용 |
|------|------|
| **방식** | 전용 번역 API 없음. **Chat Completions**(예: gpt-4o-mini)로 번역 프롬프트 호출. |
| **요금** | **토큰당** 과금 (예: gpt-4o-mini $0.15/100만 input, $0.60/100만 output) |
| **추정** | 한/일 1자 ≈ 1~2 토큰 가정 시, 2,000자 메시지 1건 ≈ 4,000 input + 4,000 output → **약 $0.003/건**. 월 1만 건 ≈ **약 $30**. |
| **특징** | 별도 가입 없이 기존 키로 가능하지만, **문자당 비용이 번역 전용 API보다 비쌀 가능성**이 큼. |

- [OpenAI Pricing](https://openai.com/api/pricing)

---

## 3. 비용 요약 (추정)

**가정**:  
- 메시지당 평균 **200자**, 월 **번역 2,500건** (실제 “번역” 버튼 클릭만)  
- 월 **50만 문자** 수준.

| 서비스 | 월 50만 문자 기준 추정 비용 | 비고 |
|--------|----------------------------|------|
| **Google Translation** | **$0** | 무료 50만 문자 이내 |
| **DeepL API Free** | **$0** | 무료 50만 문자 이내 |
| **Azure Translator** | **약 $5** | $10/100만 × 50만 |
| **OpenAI (gpt-4o-mini)** | **약 $15~30** | 토큰 수에 따라 변동 |

**트래픽이 더 커질 때 (월 200만 문자)**  
- Google: 50만 무료 후 150만 × $20/100만 = **약 $30**  
- DeepL Free: 50만만 무료, 초과 시 Pro 전환 필요  
- Azure: **약 $20**

---

## 4. 권장안 및 결론

| 항목 | 권장 |
|------|------|
| **구현 방식** | **온디맨드 번역** (메시지별 "번역" 버튼) + **번역 결과 캐시**(동일 메시지 재번역 방지) |
| **API 선택** | **비용 우선**: **DeepL API Free** 또는 **Google Cloud Translation**(무료 50만 문자)으로 시작. 이미 GCP 사용 중이면 Google, 새로 쓸 경우 DeepL Free가 설정 간단. |
| **비용** | **소규모(월 50만 문자 이하)**: **$0** (Google 또는 DeepL Free). 그 이상이면 Google 기준 **약 $20/100만 문자**, Azure **약 $10/100만 문자** 수준으로 예상. |

### Feasibility 결론

- **기술적 타당성**: ✅ **가능**. 메시지 UI에 버튼 추가 + 번역 전용 API 라우트 + (선택) 캐시 테이블/메모리로 구현 가능.  
- **비용**: ✅ **$0부터 시작 가능**(무료 티어 활용). 사용량이 늘어나도 문자당 단가가 낮아 예측 가능.  
- **리스크**: 번역 API 키·환경 변수 추가, (캐시 시) 스키마 또는 Redis 등 캐시 저장소 도입 시 운영 포인트만 고려하면 됨.

이 문서를 바탕으로 “번역” 버튼·API·캐시 설계 단계로 진행할 수 있습니다.
